# Icecast-Header-Overflow_PenTest
Exploiting a machine running Icecast via a buffer overflow vulnerability - Work in progress

## Scope:

The goal is to perform an internal penetration test on a hypothetical employees computer.
The internal penetration test is to determine if the employees computer is at risk of a real world attack.
The objective was to exploit any vulnerable software, find any secret files, and report findings back to the company.

The test found several vulnerabilities on the employees computer and was able to gain access to the machine and exfiltrate secret files including a 'secret' file, a recipe file, and a password file.

## High Level Summary of Findings:

**Machine IP:**

192.168.0.20

**Hostname:**

MSEDGEWIN10

**Vulnerability Exploited:**

exploit/windows/icecast_header (aka Icecast Header Overwrite)

**Vulnerability Explanation:**

The exploit sends 32 HTTP headers to the Icecast service (versions 2.0.1 & 2.0.0 affected). When run on a Windows device, a saved instruction pointer references a memory location that is outside the pointer array, exploited by sended the previously mentioned HTTP headers. Doing so allows the memory to be overwritten and an attacker to execute arbitrary code on the remote host with the same privileges as the Icecast service.

**Severity:**

Severe - Allows for remote code execution on the targeted host.

This exploit has the ability to compromise the confidentiality and integrity of the targeted host.

## Proof of Concept:

![Nmap of target](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/Nmap.PNG)

![Searchsploit services](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/searchsploit.PNG)

![Searching metasploit](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/mssearch.PNG)

![MS Icecast Module](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/msicecastmodule.PNG)

![MS Icecast Exploit](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/msicecastexploit.PNG)

![Enumeration 1](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/enum1.PNG)

![Enumeration 2](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/enum2.PNG)

![Enumeration 3](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/enum3.PNG)

![Enumeration 4](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/enum4.PNG)

![Exfiltration](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/exfiltration.PNG)

![MP to Shell](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/mstoshell.PNG)

![Exploit suggester](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/msexploitsuggester.PNG)

![MS Post Exp](https://github.com/TaylorTopp/Icecast-Header-Overflow_PenTest/blob/main/Images/mspost1.PNG)
